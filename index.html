<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #ffffff;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            overflow: hidden;
        }
        
        #spoiler {
            font-size: 14px;
            color: #000000;
            display: none;
            cursor: default;
            max-width: 200px;
            text-align: center;
            line-height: 1.4;
        }
        
        .hidden {
            display: none !important;
        }
        
        .no-select {
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }
    </style>
</head>
<body class="no-select">
    <div id="spoiler"></div>

    <script>
        // Запрет контекстного меню без сообщений
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            return false;
        });
        
        // Запрет горячих клавиш без сообщений
        document.addEventListener('keydown', function(e) {
            if (
                e.ctrlKey && (e.keyCode === 85 || e.keyCode === 83) ||
                e.keyCode === 123 ||
                (e.ctrlKey && e.shiftKey && (e.keyCode === 73 || e.keyCode === 74 || e.keyCode === 67))
            ) {
                e.preventDefault();
                return false;
            }
        });
        
        // Полная блокировка выделения
        document.addEventListener('selectstart', function(e) {
            if (!document.getElementById('spoiler').style.display || 
                document.getElementById('spoiler').style.display === 'none') {
                e.preventDefault();
                return false;
            }
        });
        
        // Блокировка копирования
        document.addEventListener('copy', function(e) {
            e.preventDefault();
            return false;
        });
        
        // Блокировка вставки и перетаскивания
        document.addEventListener('paste', function(e) {
            e.preventDefault();
            return false;
        });
        
        document.addEventListener('dragstart', function(e) {
            e.preventDefault();
            return false;
        });
        
        // Основная логика тряски
        let shakeCount = 0;
        let shakeTimer = null;
        let isShaking = false;
        let lastShakeTime = 0;
        const SHAKE_THRESHOLD = 15;
        const SHAKE_DURATION = 5000; // 5 секунд
        const SHAKE_INTERVAL = 200;
        let spoilerRevealed = false;
        
        const spoilerElement = document.getElementById('spoiler');
        
        // Начальная проверка разрешений для iOS
        if (typeof DeviceMotionEvent !== 'undefined' && typeof DeviceMotionEvent.requestPermission === 'function') {
            // Автоматически запрашиваем разрешение при первом касании
            let permissionRequested = false;
            document.addEventListener('touchstart', function requestPermissionOnce() {
                if (!permissionRequested) {
                    permissionRequested = true;
                    DeviceMotionEvent.requestPermission()
                        .then(permissionState => {
                            if (permissionState === 'granted') {
                                startShakeDetection();
                            }
                        })
                        .catch(() => {});
                }
            }, { once: true });
        } else {
            // Для Android и других устройств
            startShakeDetection();
        }
        
        function startShakeDetection() {
            window.addEventListener('devicemotion', handleMotion);
        }
        
        function handleMotion(event) {
            if (spoilerRevealed) return; // Если текст уже показан, не обрабатываем тряску
            
            const acceleration = event.accelerationIncludingGravity;
            const currentTime = new Date().getTime();
            
            if (currentTime - lastShakeTime < SHAKE_INTERVAL) {
                return;
            }
            
            const shakeForce = Math.abs(acceleration.x) + Math.abs(acceleration.y) + Math.abs(acceleration.z);
            
            if (shakeForce > SHAKE_THRESHOLD) {
                lastShakeTime = currentTime;
                
                if (!isShaking) {
                    isShaking = true;
                    shakeCount = 0;
                    
                    // Создаем визуальный индикатор тряски (невидимый для пользователя)
                    const indicator = document.createElement('div');
                    indicator.style.position = 'fixed';
                    indicator.style.top = '-100px';
                    indicator.style.left = '-100px';
                    indicator.style.width = '1px';
                    indicator.style.height = '1px';
                    indicator.style.opacity = '0';
                    document.body.appendChild(indicator);
                    
                    shakeTimer = setInterval(() => {
                        shakeCount += 100;
                        
                        // Обновляем индикатор
                        indicator.textContent = Math.floor(shakeCount / 1000);
                        
                        if (shakeCount >= SHAKE_DURATION) {
                            clearInterval(shakeTimer);
                            isShaking = false;
                            document.body.removeChild(indicator);
                            revealSpoiler();
                        }
                    }, 100);
                }
            }
        }
        
        function revealSpoiler() {
            // Расшифрованный текст спойлера
            const spoilerText = decodeURIComponent('%D0%AE%D0%97%D0%98%D0%9B%D0%98%D0%A9%D0%95');
            
            spoilerElement.textContent = spoilerText;
            spoilerElement.style.display = 'block';
            spoilerRevealed = true;
            
            // Останавливаем обработку тряски
            window.removeEventListener('devicemotion', handleMotion);
        }
        
        // Останавливаем тряску, если телефон перестали трясти
        let inactivityTimer;
        window.addEventListener('devicemotion', function checkInactivity() {
            if (isShaking && !spoilerRevealed) {
                clearTimeout(inactivityTimer);
                inactivityTimer = setTimeout(() => {
                    if (isShaking) {
                        clearInterval(shakeTimer);
                        isShaking = false;
                        shakeCount = 0;
                    }
                }, 500);
            }
        });
        
        // Защита от переключения вкладок - текст остается видимым
        document.addEventListener('visibilitychange', function() {
            if (spoilerRevealed && document.hidden) {
                // При возвращении на страницу текст остается видимым
                setTimeout(() => {
                    if (document.hidden === false && spoilerRevealed) {
                        spoilerElement.style.display = 'block';
                    }
                }, 100);
            }
        });
        
        // Защита от iframe
        if (window.self !== window.top) {
            window.top.location = window.self.location;
        }
        
        // Минимальная защита от DevTools (без сообщений)
        setInterval(function() {
            const debugDiv = document.createElement('div');
            debugDiv.style.display = 'none';
            Object.defineProperty(debugDiv, 'id', {
                get: function() {
                    document.body.innerHTML = '';
                    throw new Error('Debugging detected');
                }
            });
            console.log(debugDiv);
        }, 5000);
        
    </script>
    
    <noscript>
        <style>
            body { display: none !important; }
        </style>
    </noscript>
</body>
</html>
