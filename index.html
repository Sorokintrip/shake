<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
            text-align: center;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }
        
        #spoiler {
            font-size: 14px;
            color: #333;
            display: none;
            cursor: default;
            max-width: 300px;
            word-break: break-word;
            line-height: 1.4;
        }
        
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            color: white;
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            font-size: 14px;
            text-align: center;
            padding: 20px;
        }
        
        .hidden-text {
            display: none;
        }
        
        .no-select {
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }
    </style>
</head>
<body class="no-select" oncontextmenu="return false;">
    <div id="spoiler"></div>
    
    <div class="overlay" id="protectionOverlay">
        Доступ запрещен
    </div>

    <div class="hidden-text" id="encryptedSpoiler">%D0%AE%D0%97%D0%98%D0%9B%D0%98%D0%A9%D0%95</div>

    <script>
        // Блокировка контекстного меню
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
            showProtectionOverlay();
            return false;
        });
        
        // Блокировка горячих клавиш
        document.addEventListener('keydown', function(e) {
            if (
                e.ctrlKey && (e.keyCode === 85 || e.keyCode === 83) ||
                e.keyCode === 123 ||
                (e.ctrlKey && e.shiftKey && (e.keyCode === 73 || e.keyCode === 74 || e.keyCode === 67))
            ) {
                e.preventDefault();
                showProtectionOverlay();
                return false;
            }
        });
        
        // Блокировка выделения текста
        document.addEventListener('selectstart', function(e) {
            if (!document.getElementById('spoiler').style.display || 
                document.getElementById('spoiler').style.display === 'none') {
                e.preventDefault();
                return false;
            }
        });
        
        // Блокировка копирования
        document.addEventListener('copy', function(e) {
            if (!document.getElementById('spoiler').style.display || 
                document.getElementById('spoiler').style.display === 'none') {
                e.preventDefault();
                showProtectionOverlay();
                return false;
            }
        });
        
        // Защита от вставки и перетаскивания
        document.addEventListener('paste', function(e) {
            e.preventDefault();
            return false;
        });
        
        document.addEventListener('dragstart', function(e) {
            e.preventDefault();
            return false;
        });
        
        // Защита от DevTools
        function detectDevTools() {
            const threshold = 160;
            const widthThreshold = window.outerWidth - window.innerWidth > threshold;
            const heightThreshold = window.outerHeight - window.innerHeight > threshold;
            
            if (widthThreshold || heightThreshold) {
                showProtectionOverlay();
                document.body.innerHTML = '';
                document.body.style.backgroundColor = 'black';
            }
        }
        
        setInterval(detectDevTools, 1000);
        
        function showProtectionOverlay() {
            const overlay = document.getElementById('protectionOverlay');
            overlay.style.display = 'flex';
            setTimeout(() => {
                overlay.style.display = 'none';
            }, 2000);
        }
        
        // Основная логика тряски
        let shakeCount = 0;
        let shakeTimer = null;
        let isShaking = false;
        let lastShakeTime = 0;
        const SHAKE_THRESHOLD = 15;
        const SHAKE_DURATION = 3000;
        const SHAKE_INTERVAL = 200;
        
        const spoilerElement = document.getElementById('spoiler');
        let spoilerRevealed = false;
        
        // Проверяем поддержку DeviceMotionEvent
        if (typeof DeviceMotionEvent !== 'undefined' && typeof DeviceMotionEvent.requestPermission === 'function') {
            // iOS 13+ требует разрешения
            document.body.addEventListener('click', function() {
                DeviceMotionEvent.requestPermission()
                    .then(permissionState => {
                        if (permissionState === 'granted') {
                            startShakeDetection();
                        }
                    })
                    .catch(console.error);
            });
        } else {
            startShakeDetection();
        }
        
        function startShakeDetection() {
            window.addEventListener('devicemotion', handleMotion);
        }
        
        function handleMotion(event) {
            const acceleration = event.accelerationIncludingGravity;
            const currentTime = new Date().getTime();
            
            if (currentTime - lastShakeTime < SHAKE_INTERVAL) {
                return;
            }
            
            const shakeForce = Math.abs(acceleration.x) + Math.abs(acceleration.y) + Math.abs(acceleration.z);
            
            if (shakeForce > SHAKE_THRESHOLD) {
                lastShakeTime = currentTime;
                
                if (!isShaking) {
                    isShaking = true;
                    shakeCount = 0;
                    
                    shakeTimer = setInterval(() => {
                        shakeCount += 100;
                        
                        if (shakeCount >= SHAKE_DURATION) {
                            clearInterval(shakeTimer);
                            showSpoiler();
                        }
                    }, 100);
                }
            }
        }
        
        function showSpoiler() {
            const encoded = document.getElementById('encryptedSpoiler').textContent;
            const decodedText = decodeURIComponent(encoded);
            
            spoilerElement.textContent = decodedText;
            spoilerElement.style.display = 'block';
            isShaking = false;
            spoilerRevealed = true;
            
            spoilerElement.style.userSelect = 'text';
            spoilerElement.style.webkitUserSelect = 'text';
            
            setTimeout(() => {
                spoilerElement.style.display = 'none';
                spoilerElement.style.userSelect = 'none';
                spoilerElement.style.webkitUserSelect = 'none';
                spoilerRevealed = false;
            }, 10000);
        }
        
        // Останавливаем тряску, если телефон перестали трясти
        let inactivityTimer;
        window.addEventListener('devicemotion', () => {
            clearTimeout(inactivityTimer);
            inactivityTimer = setTimeout(() => {
                if (isShaking) {
                    clearInterval(shakeTimer);
                    isShaking = false;
                    shakeCount = 0;
                }
            }, 500);
        });
        
        // Объект для хранения текста
        Object.defineProperty(window, 'spoilerText', {
            value: decodeURIComponent('%D0%AE%D0%97%D0%98%D0%9B%D0%98%D0%A9%D0%95'),
            writable: false,
            configurable: false,
            enumerable: false
        });
        
        // Запрет на открытие в iframe
        if (window.self !== window.top) {
            document.body.innerHTML = '';
            document.body.style.backgroundColor = 'black';
        }
        
        // Искажение в DevTools
        const debugHandler = setInterval(() => {
            const start = new Date();
            debugger;
            const end = new Date();
            if (end - start > 100) {
                document.body.innerHTML = '';
                document.body.style.backgroundColor = 'black';
                clearInterval(debugHandler);
            }
        }, 1000);
        
        // Скрытие кода при переключении вкладок
        document.addEventListener('visibilitychange', function() {
            if (document.hidden && spoilerRevealed) {
                spoilerElement.style.display = 'none';
                spoilerRevealed = false;
            }
        });
    </script>
    
    <noscript>
        <style>
            body { display: none !important; }
        </style>
    </noscript>
</body>
</html>
